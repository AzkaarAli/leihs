{{if lines.length}}
${$grouped_lines = App.Line.groupByDateRanges(lines), ""}

%li.items.hastip
  %span.number
    ${quantity}
  ${_jed(quantity, "Item", "Items")}
  .tip.lines
    {{each(i, linegroup) $grouped_lines}}
    {{if i != 0}}
    %hr
    {{/if}}
    .date
      {{html moment(start_date).format(i18n.date.L)}}
      = "-"
      {{html moment(end_date).format(i18n.date.L)}}
    .range
      ${$days = moment(linegroup.end_date).eod().diff(moment(linegroup.start_date).sod(), "days"), ""}
      ${$days}
      ${_jed($days, "day")}
    .clear
    %table
      ${$grouped_lines_by_model = App.Line.mergeByModel(linegroup.lines), ""}
      {{each(i, line) $grouped_lines_by_model}}
      %tr
        %td.quantity
          ${line.quantity}
        %td.model_name
          {{if line.model}}
          {{html String(line.model.name).substring(0, 45) }}
          {{if String(line.model.name).length > 45}}
          {{html "..."}}
          {{/if}}
          {{else}}
          %i ${_jed("Model not present anymore")}
          {{/if}}
      {{/each}}
    {{/each}}
{{else}}
%li.items
  %span.number= "0"
  ${_jed("Items")}
{{/if}}
