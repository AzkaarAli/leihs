-content_for :title, _("Search Results for \"%s\"") % params[:text]

#search_results.innercontent
  %h1= _("Search Results for \"%s\"") % params[:text]
  
  %p.subtitle= _("Found %d matches") % @hits.values.sum
  
  %hr
  
  %section.model
    .inlinetabs
      .tab
        .icon.model
        %span.text
          = _("Models")
        .badge
          = @hits["model"]
    .list
    
  %section.item
    .inlinetabs
      .tab
        .icon.item
        %span.text
          = _("Items")
        .badge
          = @hits["item"]
    .list
  
  %section.user
    .inlinetabs
      .tab
        .icon.user
        %span.text
          = _("Users")
        .badge
          = @hits["user"]
    .list
    
  %section.contract
    .inlinetabs
      .tab
        .icon.contract
        %span.text
          = _("Contracts")
        .badge
          = @hits["contract"]
    .list
    
  %section.order
    .inlinetabs
      .tab
        .icon.orders
        %span.text
          = _("Orders")
        .badge
          = @hits["order"]
    .list
    
:javascript
  
  $(document).ready(function(){
    $('.list').hide();
  
    $.each(#{@results.to_json}, function(i, result){
      $('.'+result.type+' .list').append($.tmpl("tmpl/line", result)).parent().show();
    });
    
    $(".list").each(function(){
      var text = $(this).parent().find(".tab .text").first().html();
          text = text.replace(/<.*>.*<\/.*>/g, "");
      $(this).showMore({
        min: 4,
        offset: {
          top: -36
        },
        more: "<li><span class='icon'></span>#{_('more')} "+text+"</li>",
        less: "<li><span class='icon'></span>#{_('show less')}</li>"
      });
    });
    
    $('.list').show();
  });
