h = {
  :partitions => (model.partitions.in(inventory_pool).by_groups(inventory_pool.groups) + model.partitions.in(inventory_pool).by_groups(Group::GENERAL_GROUP_ID)).as_json(:include => :group),
  :availability => model.availability_changes_in(inventory_pool).changes.available_total_quantities
}

w1 = {closed_days: true, holidays: true}
h[:inventory_pool] = render(:partial => "inventory_pools/show.json.rjson", :locals => {:inventory_pool => inventory_pool, with: w1}) # FIXME extract this

h