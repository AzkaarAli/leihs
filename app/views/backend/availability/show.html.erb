<% content_tag :h3 do %>
	<%= _("Overbooking") %>
<% end %>

<% content_tag :table do
    content_tag :tr do
      [_("Model"),
       _("Period"),
       _("Overbooked Quantity")].each do |s|
        content_tag :th do %>
          <%= s %>  
        <% end
      end
    end

	last_model = nil
	@overbooking_availabilities.each do |ob|
		ob.changes.each do |c|
			quantities = c.quantities.select {|q| q.in_quantity < 0 } 
			next if quantities.empty? 
			content_tag :tr do
				content_tag :td do %>
					<%= ob.model == last_model ? '"' : show_line_model(ob.model)  %>
				<% end
				content_tag :td do %>
		  			<%= dates_with_period(c.start_date, ob.changes.end_date_of(c)) %>  
				<% end
				content_tag :td do %>
		  			<%= quantities.collect(&:in_quantity).sum %>  
				<% end
			end
			last_model = ob.model
		end
	end

end %>