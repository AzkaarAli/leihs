#!/bin/bash
# use erb instead of this hack?

TODO_SRC=features/todo.feature
TODO_DST=doc/todo.html

(
  # write head of html document
  cat<<EOH
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 
		<style type="text/css">
			div {
				width: 7cm;
			}
			div.Scenario {
				margin-top: 1cm;
			}
			div.Given {
				margin-bottom: 2cm;
				font-size:80%
			}
			div.topcomment {
				margin-bottom: 2cm;
				font-size:80%
			}
		</style>
	</head>
	<body>
		<div class="topcomment">Leihs todos from the round table: automatically generated from $TODO_SRC by "rake leihs:todo"</div>

EOH
  cat $TODO_SRC \
  | grep "\(Scenario\)\|\(Given pending\)" \
  | sed "s/Scenario:\(.*\)/		<div class=\"Scenario\">\1<\/div>/" \
  | sed "s/\s*Given pending\(.*\)/		<div class=\"Given pending\">\1<\/div>/"
  # write tail of html document
  cat<<EOB
	</body>
</html>
EOB
) > $TODO_DST
